---
title: "Progetto"
author: "Matteo Caiola, Lorenzo Cusin, Leonardo Micheluz, Andrea Tonello"
date: "2023-07-12"
output:
  html_document: default
  pdf_document: default
editor_options:
  markdown:
    wrap: 72
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	results = FALSE
)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(results = FALSE)
knitr::opts_chunk$set(warning = FALSE)
```

```{r tinytex, echo = FALSE, message = FALSE, results = FALSE}
#tinytex::install_tinytex()
```

```{r,echo = TRUE, include=FALSE}
library(MASS)
library(ggplot2)
library(tidyverse)
library(corrplot)
library(gridExtra)
library(factoextra)
library(cluster)
library(epiR)
library(scales)
library(lubridate)


```

```{r , include=TRUE}

data<-read.csv("breast-cancer.csv", sep=",")
```

```{r lib, echo = FALSE, message = FALSE, results = FALSE}
#install.packages("gvlma")
#install.packages("ggcorrplot")
library(ggcorrplot)
library(gvlma)
library(tidyverse)
library(ggExtra)
library(cowplot)
library(magrittr)
library(gtable)
library(lattice)
library(grid)
library(gridExtra)
library(corrplot)
library(ggplot2)
library(GGally)
library(MASS)
library(kableExtra)
```

```{r load, echo = FALSE, results = FALSE, message = FALSE}
str(data)
dim(data)
```

```{r}
missing_values <- colSums(is.na(data))
print(missing_values)
```

```{r fig.height=10, fig.width=10}
corr_mat = cor(data[, -c(2)])  # matrice di correlazione
corr = round(corr_mat, 1)


cex.before <- par("cex")
par(mfrow=c(1, 1))
corrplot(
  corr_mat,
  method = "color",
  addCoef.col = 1,
  number.cex = 0.8,
  tl.cex = 0.6,
  tl.col = "black",
  col=colorRampPalette(c("black","white","red"))(1000),
  order = "AOE",
  addCoefasPercent = TRUE
)
par(cex = cex.before)
```

```{r}
data$diagnosis<-factor(data$diagnosis)
str(data$diagnosis)
```

```{r load, echo = FALSE, results = FALSE, message = FALSE}
data$diagnosis<-factor(data$diagnosis, labels=c("B","M"))

str(data)

```

```{r fig.height=30, fig.width=40}
library(ggplot2)


# Ottenere il numero di colonne nel dataframe
num_colonne <- ncol(data)

# Creare una lista vuota per memorizzare i plot
plots_list <- list()

# Creare un ciclo for per iterare su tutte le colonne tranne le prime due
for (i in 3:num_colonne) {
  
  # Creare il boxplot per la colonna i-esima
  plot <- ggplot(data = data, aes_string(x = "diagnosis", y = names(data)[i], color = "diagnosis")) + 
    geom_boxplot() +
    theme(legend.position = "none", text= element_text(size = 25))+
    labs(x = "", y = names(data)[i]) +
    scale_color_manual(labels = c("B", "F"), values = c("darkorange", "cyan4")) 
  
    
  # Aggiungere il plot alla lista
  plots_list[[i-2]] <- plot
}

# Creare una griglia di plot utilizzando facet_wrap
grid_plot <- do.call(gridExtra::grid.arrange, c(plots_list, ncol = 5))

# Visualizzare la griglia di plot
grid_plot

length(plots_list)
```

```{r}
ggplot(data, aes(x=concave.points_worst, y=radius_mean, color= diagnosis))+
  geom_point()
```

```{r}
ggplot(data, aes(x=concave.points_worst, y=radius_mean, color= diagnosis))+
  geom_point()
```

```{r}
ggplot(data, aes(x=concave.points_worst, y=radius_mean, color= diagnosis))+
  geom_point()
```

```{r}
ggplot(data, aes(x=concave.points_worst, y=area_worst, color= diagnosis))+
  geom_point()
```

```{r}
ggplot(data, aes(x=concave.points_mean, y=radius_mean, color= diagnosis))+
  geom_point()
```
